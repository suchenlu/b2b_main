<!DOCTYPE html>
<html>
  <head>
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link href="../../../static/css/bootstrap.min.css" rel="stylesheet" media="screen">
    <!-- <link href="../../../static/css/bootstrap-theme.min.css" rel="stylesheet" media="screen"> -->
    <link rel="stylesheet" type="text/css" href="../../../static/css/base.css"/>
    <link rel="shortcut icon" type="image/x-icon" href="../../../static/img/logo2.png" />

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

<style>
    input{overflow: hidden;}
    input[type="file"]{width: 100%;}
</style>

  </head>
  <body id="B2B" >
    

  <div class="container-fluid">
    
        
    



<form action="" method="POST" enctype="multipart/form-data">
    
    <div >
        产品主图
        <div class="row">
            <div class="col-sm-3">
                产品主图1
                
            </div>
            <div class="col-sm-3">
                <input type="file" name="main_pic" id="main_pic"  />
            </div>
            <div class="col-sm-3">
                <img src="../../../static/upload/16128541ac3bef86c9bdb437a75fead3_thumbnail.jpeg" id="main_pic_img" />
                <input type="hidden" value="../../../static/upload/16128541ac3bef86c9bdb437a75fead3_thumbnail.jpeg" name="main_pic_hid" id="main_pic_hid"/>
            </div>

        </div>
    </div>
    <div>
        产品轮播图 －
        

        
        <div class="row">
            <div class="col-sm-3">

                第1张轮播图

            </div>
            <div class="col-sm-3">
                <input type="file" name="lunbo_1" id="lunbo_1" />
            </div>
            <div class="col-sm-3">
                <img src="../../../static/upload/e73619515751e6ce41a1c3e67ea43ec2_thumbnail.jpeg"  id="lunbo_1_img"/>
                <input  type="hidden" value="../../../static/upload/e73619515751e6ce41a1c3e67ea43ec2_thumbnail.jpeg" name="lunbo_1_hid" id="lunbo_1_hid"/>
            </div>

        </div>
        
        <div class="row">
            <div class="col-sm-3">

                第2张轮播图

            </div>
            <div class="col-sm-3">
                <input type="file" name="lunbo_1" id="lunbo_2" />
            </div>
            <div class="col-sm-3">
                <img src="../../../static/upload/02d649996962a7965b825112f4c51089_thumbnail.jpeg"  id="lunbo_2_img"/>
                <input  type="hidden" value="../../../static/upload/02d649996962a7965b825112f4c51089_thumbnail.jpeg" name="lunbo_2_hid" id="lunbo_2_hid"/>
            </div>

        </div>
        
        <div class="row">
            <div class="col-sm-3">

                第3张轮播图

            </div>
            <div class="col-sm-3">
                <input type="file" name="lunbo_1" id="lunbo_3" />
            </div>
            <div class="col-sm-3">
                <img src="../../../static/upload/777f477594131f75e0de0499bee5be01_thumbnail.jpeg"  id="lunbo_3_img"/>
                <input  type="hidden" value="../../../static/upload/777f477594131f75e0de0499bee5be01_thumbnail.jpeg" name="lunbo_3_hid" id="lunbo_3_hid"/>
            </div>

        </div>
        
        <div class="row">
            <div class="col-sm-3">

                第4张轮播图

            </div>
            <div class="col-sm-3">
                <input type="file" name="lunbo_1" id="lunbo_4" />
            </div>
            <div class="col-sm-3">
                <img src=""  id="lunbo_4_img"/>
                <input  type="hidden" value="" name="lunbo_4_hid" id="lunbo_4_hid"/>
            </div>

        </div>
        
    </div>
    <div>
        <div>产品行程图</div>
        
        <div class="row">
            <div class="col-sm-3">
                第 1 天行程图<br>
                
            </div>
            <div class="col-sm-3">

                大图 ： <input type="file" name="xingcheng_main_1" id="xingcheng_main_1" />
                说明信息 ：<input type="text" name="xingcheng_main_1_hid_mess" id="xingcheng_main_1_hid_mess" value=""/></br>
                小图 ： <input type="file" name="xingcheng_mini_1" id="xingcheng_mini_1" />
            </div>
            <div class="col-sm-2">
                <img  src="../../../static/default/ware-default-b1180_thumbnail.jpg"
                                                                                                  id="xingcheng_main_1_img">
                <input type="hidden"  value="../../../static/default/ware-default-b1180_thumbnail.jpg"
                                                        id="xingcheng_main_1_hid"  name="xingcheng_main_1_hid"/>
                <img  src="../../../static/default/ware-default-s253_thumbnail.jpg"
                                                       id="xingcheng_mini_1_img">
                <input type="hidden"   value="../../../static/default/ware-default-s253_thumbnail.jpg"
                                                        id="xingcheng_mini_1_hid" name="xingcheng_mini_1_hid"/>
            </div>
        </div>
        
    </div>
    <input type="submit" value="提交" />
    <a class="btn btn-danger btn-sm" href="/manage/wares/list/1/100"> 返回 </a>
</form>


    </div>


<script src="../../../static/js/jquery.js"></script>
<script src="../../../static/js/bootstrap.min.js"></script>

<script>
    $(document).ready(function() {

        upimg('main_pic');
        upimg('lunbo_1');
        upimg('lunbo_2');
        upimg('lunbo_3');
        upimg('lunbo_4');
        
        upimg('xingcheng_main_1')
        upimg('xingcheng_mini_1')
        
    });
</script>

<script >
    function checkImgType(ths){
        if (ths.value == "") {
            alert("请上传图片");
            return false;
        } else {
            if (!/\.(gif|jpg|jpeg|png|GIF|JPG|PNG)$/.test(ths.value)) {
                alert("图片类型必须是.gif,jpeg,jpg,png中的一种");
                ths.value = "";
                return false;
            }

            else
            {
                var img=new Image();
                img.src=filepath;
                while(true){
                    if(img.fileSize>0){
                        if(img.fileSize>2*1024){
                            alert("图片不大于10M。");
                            return false;
                        }
                        break;
                    }

                }
            }
        }
        return true;
    }

    function upimg(id) {
        // alert(id);
        var hi = $("#" + id + '_hid').val();
        if (hi != '') {
            $("#" + id + "_img").attr('src', hi);
        }

        $("#" + id).change(function () {
            filepath = $('#'+ id).val();
            target = this;
            var extStart=filepath.lastIndexOf(".");

            var ext=filepath.substring(extStart,filepath.length).toUpperCase();

            if(ext!=".PNG"&&ext!=".JPG"&&ext!=".JPEG"){
                alert("图片限于png,jpeg,jpg格式");
                return false;
            }

            var isIE = /msie/i.test(navigator.userAgent) && !window.opera;

            var fileSize = 0;
            if (isIE && !target.files){
                var filePath = target.value;
                var fileSystem = new ActiveXObject("Scripting.FileSystemObject");
                var file = fileSystem.GetFile (filePath);
                fileSize = file.Size;
            } else {
                fileSize = target.files[0].size;
            }

            var size = fileSize/(1024*1024);

            if (size >1){
                alert('图片尺寸不能大于1M');
                return false;
            }

            var data = new FormData();
            $.each($("#" + id)[0].files, function (i, file) {
                data.append('upload_file', file);
            });

            $.ajax({
                url: '/manage/wares/upimg',
                type: 'POST',
                data: data,
                cache: false,
                contentType: false,    //不可缺
                processData: false,    //不可缺
                success: function (data) {

                    if (data != '') {
                        $("#" + id + '_img').attr("src", data);
                        $("#" + id + '_hid').val(data);
                        //alert($("#" + id + '_hid').val());

                    }
                }
            });
        });
    }
</script>



  </body>
</html>
